{{ include('layout/header.html') }}

<h1>{{ title }}</h1>
{% include 'page-elements/in-page-links.html' %}

{% include 'flexible_content.twig' with { 'flexible_content': fields.flexible_content.value } %}

<p>{{ query_result.summary }}</p>
<div class="knowledge-filters">
  <span>Show me</span>
  <select id="type" name="type">
    <option value="" {% if selected_publication_type.ID == NULL %} selected {% endif %}>All types</option>
    {% for publication_type in publication_types %}
      <option value="{{ publication_type.post_name }}" {% if selected_publication_type.ID == publication_type.ID %} selected {% endif %} >{{ publication_type.post_title }}</option>
    {% endfor %}
  </select>
</div>

<script>
    function updateType() {
        var url = new URL(document.location);
        var type = $("#type").val();
        if (type) {
            url.searchParams.set("type", type);
        } else {
            url.searchParams.delete("type");
        }
        document.location = url.toString();
    }

    $(function() {
        $("#type").on("change", updateType);
    });
</script>

<div class="card-container two-max">
  {% for publication in query_result.posts %}
    {% include 'cards/entities/publication-large.html' %}
  {% endfor %}
</div>

{% include 'page-elements/pagination-links.html' %}

{{ include('layout/footer.html') }}